load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_1.RData")
tlist <- list ()
for( i in 1:length(res[[1]]$rmse) ){
toremove <-c( (1:length(res[[1]]$rmse))[-i], (1:length(res[[1]]$ARI))[-i]+ length(res[[1]]$rmse))
tt <- tres[,- toremove ]
tlist[[i]] <- cbind ( rep(colnames(tres)[i], nrow(tt)), tt  )
colnames(tlist[[i]])[c(1,2,3,4)] <- c("Method", "RMSE", "ARI", "noise_level")
}
df_simu <- do.call(rbind, tlist)
df_simu <- as.data.frame(df_simu)
df_simu$Method <- as.factor(df_simu$Method)
df_simu$RMSE <- as.numeric(df_simu$RMSE)
df_simu$ARI <- as.numeric(df_simu$ARI)
library(ggplot2)
ggplot(df_simu, aes(x=Method, y=RMSE, color=Method)) +
geom_boxplot()  +
facet_wrap(~noise_level )
ggplot(df_simu, aes(x=Method, y=ARI, color=Method)) +
geom_boxplot()  +
facet_wrap(~noise_level, scales="free")
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_1.RData")
tres <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_2.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_3.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_4.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/check_cEBMF_1.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/check_cEBMF_1.RData")
plot(tres[,1],tres[,3])
abline(a=0,b=1)
tres[,1] <- apply(tres[ ,c(1,2)],1, min)
for( i in 1:length(res[[1]]$rmse ) ){
toremove <- (1:length(res[[1]]$rmse))[-i]
tt <- tres[,- toremove ]
tlist[[i]] <- data.frame ( rep(colnames(tres)[i], nrow(tt)), tt)
colnames(tlist[[i]])[c(1,2)] <- c("Method", "RMSE")
}
df_simu <- do.call(rbind, tlist)
df_simu <- as.data.frame(df_simu)
df_simu$Method <- as.factor(df_simu$Method)
library(ggplot2)
ggplot(df_simu, aes(x=Method, y=RMSE, color=Method)) +
geom_boxplot() +
facet_wrap(~noise_level) +
scale_y_log10()
tlist <- list()
for( i in 1:length(res[[1]]$rmse ) ){
toremove <- (1:length(res[[1]]$rmse))[-i]
tt <- tres[,- toremove ]
tlist[[i]] <- data.frame ( rep(colnames(tres)[i], nrow(tt)), tt)
colnames(tlist[[i]])[c(1,2)] <- c("Method", "RMSE")
}
df_simu <- do.call(rbind, tlist)
df_simu <- as.data.frame(df_simu)
df_simu$Method <- as.factor(df_simu$Method)
library(ggplot2)
ggplot(df_simu, aes(x=Method, y=RMSE, color=Method)) +
geom_boxplot() +
facet_wrap(~noise_level) +
scale_y_log10()
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_1.RData")
tres <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_2.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_3.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_4.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/check_cEBMF_1.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/check_cEBMF_2.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/check_cEBMF_3.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/check_cEBMF_4.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/check_cEBMF_1.RData")
plot(tres[,1],tres[,3])
abline(a=0,b=1)
tres[,1] <- apply(tres[ ,c(1,2)],1, min)
tlist <- list()
for( i in 1:length(res[[1]]$rmse ) ){
toremove <- (1:length(res[[1]]$rmse))[-i]
tt <- tres[,- toremove ]
tlist[[i]] <- data.frame ( rep(colnames(tres)[i], nrow(tt)), tt)
colnames(tlist[[i]])[c(1,2)] <- c("Method", "RMSE")
}
df_simu <- do.call(rbind, tlist)
df_simu <- as.data.frame(df_simu)
df_simu$Method <- as.factor(df_simu$Method)
library(ggplot2)
ggplot(df_simu, aes(x=Method, y=RMSE, color=Method)) +
geom_boxplot() +
facet_wrap(~noise_level) +
scale_y_log10()
df_simu
ggplot(df_simu[-which(df_simu$noise_level==50),], aes(x=Method, y=RMSE, color=Method)) +
geom_boxplot() +
facet_wrap(~noise_level) +
scale_y_log10()
ggplot(df_simu[-which(df_simu$noise_level==50),], aes(x=Method, y=RMSE, color=Method)) +
geom_boxplot() +
facet_wrap(~noise_level,s cale='free') +
ggplot(df_simu[-which(df_simu$noise_level==50),], aes(x=Method, y=RMSE, color=Method)) +
geom_boxplot() +
facet_wrap(~noise_level,scale='free') +
scale_y_log10()
library(ggplot2)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_1.RData")
tres <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_2.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_3.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$ARI,res[[i]]$ noise_level ) ))
res[, ncol(res)] <- 3
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_4.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_1.RData")
tlist <- list ()
for( i in 1:length(res[[1]]$rmse) ){
toremove <-c( (1:length(res[[1]]$rmse))[-i], (1:length(res[[1]]$ARI))[-i]+ length(res[[1]]$rmse))
tt <- tres[,- toremove ]
tlist[[i]] <- cbind ( rep(colnames(tres)[i], nrow(tt)), tt  )
colnames(tlist[[i]])[c(1,2,3,4)] <- c("Method", "RMSE", "ARI", "noise_level")
}
df_simu <- do.call(rbind, tlist)
df_simu <- as.data.frame(df_simu)
df_simu$Method <- as.factor(df_simu$Method)
df_simu$RMSE <- as.numeric(df_simu$RMSE)
df_simu$ARI <- as.numeric(df_simu$ARI)
library(ggplot2)
ggplot(df_simu, aes(x=Method, y=RMSE, color=Method)) +
geom_boxplot()  +
facet_wrap(~noise_level )
ggplot(df_simu, aes(x=Method, y=ARI, color=Method)) +
geom_boxplot()  +
facet_wrap(~noise_level )
library(ggplot2)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_1.RData")
tres <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_2.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_3.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$ARI,res[[i]]$ noise_level ) ))
res[, ncol(res)] <- 3
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_4.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_1.RData")
tlist <- list ()
for( i in 1:length(res[[1]]$rmse) ){
toremove <-c( (1:length(res[[1]]$rmse))[-i], (1:length(res[[1]]$ARI))[-i]+ length(res[[1]]$rmse))
tt <- tres[,- toremove ]
tlist[[i]] <- cbind ( rep(colnames(tres)[i], nrow(tt)), tt  )
colnames(tlist[[i]])[c(1,2,3,4)] <- c("Method", "RMSE", "ARI", "noise_level")
}
df_simu <- do.call(rbind, tlist)
df_simu <- as.data.frame(df_simu)
df_simu$Method <- as.factor(df_simu$Method)
df_simu$RMSE <- as.numeric(df_simu$RMSE)
df_simu$ARI <- as.numeric(df_simu$ARI)
library(ggplot2)
ggplot(df_simu, aes(x=Method, y=RMSE, color=Method)) +
geom_boxplot()  +
facet_wrap(~noise_level )
ggplot(df_simu, aes(x=Method, y=ARI, color=Method)) +
geom_boxplot()  +
facet_wrap(~noise_level )
source("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/analyse_res.R")
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_1.RData")
tres <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_2.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_3.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_4.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/check_cEBMF_1.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/check_cEBMF_2.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/check_cEBMF_3.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/check_cEBMF_4.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/check_cEBMF_1.RData")
plot(tres[,1],tres[,3])
abline(a=0,b=1)
tres[,1] <- apply(tres[ ,c(1,2)],1, min)
tlist <- list()
for( i in 1:length(res[[1]]$rmse ) ){
toremove <- (1:length(res[[1]]$rmse))[-i]
tt <- tres[,- toremove ]
tlist[[i]] <- data.frame ( rep(colnames(tres)[i], nrow(tt)), tt)
colnames(tlist[[i]])[c(1,2)] <- c("Method", "RMSE")
}
df_simu <- do.call(rbind, tlist)
df_simu <- as.data.frame(df_simu)
df_simu$Method <- as.factor(df_simu$Method)
library(ggplot2)
ggplot(df_simu[-which(df_simu$noise_level==50 |df_simu$noise_level==10),], aes(x=Method, y=RMSE, color=Method)) +
geom_boxplot() +
facet_wrap(~noise_level,scale='free') +
scale_y_log10()
ggplot(df_simu , aes(x=Method, y=RMSE, color=Method)) +
geom_boxplot() +
facet_wrap(~noise_level,scale='free') +
scale_y_log10()
table(df_simu$Method, df_simu$noise_level)
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_1.RData")
res
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_1.RData")
rm(list=ls())
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_1.RData")
tres <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
plot(tres[,1],tres[,3])
abline(a=0,b=1)
tres[,1] <- apply(tres[ ,c(1,2)],1, min)
tlist <- list()
for( i in 1:length(res[[1]]$rmse ) ){
toremove <- (1:length(res[[1]]$rmse))[-i]
tt <- tres[,- toremove ]
tlist[[i]] <- data.frame ( rep(colnames(tres)[i], nrow(tt)), tt)
colnames(tlist[[i]])[c(1,2)] <- c("Method", "RMSE")
}
df_simu <- do.call(rbind, tlist)
df_simu <- as.data.frame(df_simu)
df_simu$Method <- as.factor(df_simu$Method)
library(ggplot2)
ggplot(df_simu[-which(df_simu$noise_level==50 |df_simu$noise_level==10),], aes(x=Method, y=RMSE, color=Method)) +
geom_boxplot() +
facet_wrap(~noise_level,scale='free') +
scale_y_log10()
df_simu
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_1.RData")
tres <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
length(res)
lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) )
do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- do.call( rbind, lapply ( 10:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres
plot(tres[,1],tres[,3])
abline(a=0,b=1)
tres[,1] <- apply(tres[ ,c(1,2)],1, min)
tlist <- list()
for( i in 1:length(res[[1]]$rmse ) ){
toremove <- (1:length(res[[1]]$rmse))[-i]
tt <- tres[,- toremove ]
tlist[[i]] <- data.frame ( rep(colnames(tres)[i], nrow(tt)), tt)
colnames(tlist[[i]])[c(1,2)] <- c("Method", "RMSE")
}
df_simu <- do.call(rbind, tlist)
df_simu <- as.data.frame(df_simu)
df_simu$Method <- as.factor(df_simu$Method)
library(ggplot2)
ggplot(df_simu[-which(df_simu$noise_level==50 |df_simu$noise_level==10),], aes(x=Method, y=RMSE, color=Method)) +
geom_boxplot() +
facet_wrap(~noise_level,scale='free') +
scale_y_log10()
res[[1]]$rmse
res[[13]]$rmse
res[[100]]$rmse
res <-list()
o=1
res[[o]] <-sim_func_cEBMF (noise_level= 2,
max_iter_cEBMF=10,
P1=100 , # number of cov for row /loadings
P2=100, # number of cov for col /factors
seed=o+1,
epoch=10)
library(softImpute)
library( comoR)
library(nnet)
library(ashr)
library(flashier)
library(irlba)
library(PMA)
res[[o]] <-sim_func_cEBMF (noise_level= 2,
max_iter_cEBMF=10,
P1=100 , # number of cov for row /loadings
P2=100, # number of cov for col /factors
seed=o+1,
epoch=10)
res
devtools::install_github('karltayeb/comoR@lean_como')
res[[o]] <-sim_func_cEBMF (noise_level= 2,
max_iter_cEBMF=10,
P1=100 , # number of cov for row /loadings
P2=100, # number of cov for col /factors
seed=o+1,
epoch=10)
res
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_1.RData")
tres <- do.call( rbind, lapply ( 10:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_2.RData")
res  <- do.call( rbind, lapply ( 10:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_3.RData")
res  <- do.call( rbind, lapply ( 10:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_4.RData")
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_1.RData")
tres <- do.call( rbind, lapply ( 10:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_2.RData")
res  <- do.call( rbind, lapply ( 10:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_3.RData")
res  <- do.call( rbind, lapply ( 10:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/check_cEBMF_4.RData")
res  <- do.call( rbind, lapply ( 10:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$par ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/check_cEBMF_1.RData")
plot(tres[,1],tres[,3])
abline(a=0,b=1)
plot(tres[,1],tres[,2])
abline(a=0,b=1)
tres[,1] <- apply(tres[ ,c(1,2)],1, min)
tlist <- list()
for( i in 1:length(res[[10]]$rmse ) ){
toremove <- (1:length(res[[10]]$rmse))[-i]
tt <- tres[,- toremove ]
tlist[[i]] <- data.frame ( rep(colnames(tres)[i], nrow(tt)), tt)
colnames(tlist[[i]])[c(1,2)] <- c("Method", "RMSE")
}
df_simu <- do.call(rbind, tlist)
df_simu <- as.data.frame(df_simu)
df_simu$Method <- as.factor(df_simu$Method)
df_simu <- df_simu[-which(df_simu$Method=="cEBMF"),]
df_simu$Method[which(df_simu$Method=="cEBMF0")] <- "cEBMF"
library(ggplot2)
P1<- ggplot(df_simu, aes(x=Method, y=RMSE, color=Method)) +
geom_boxplot() +
facet_wrap(~noise_level,scale='free',
labeller = as_labeller(function(x) paste("noise sd =", x)))  +
theme_bw()+
theme(legend.position="none",
strip.background = element_rect(fill = "white"))+
xlab("") +
ggtitle("Sparsity driven covariate")+
scale_y_log10()
P1
ggsave(P1, file="plot/simple_simu.pdf",
width = 29.7,
height = 21,
units = "cm"
)
ggplot(df_simu , aes(x=Method, y=RMSE, color=Method)) +
geom_boxplot() +
facet_wrap(~noise_level,scale='free') +
scale_y_log10()
table(df_simu$Method, df_simu$noise_level)
library(ggplot2)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_1.RData")
tres <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_2.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_3.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$ARI,res[[i]]$ noise_level ) ))
res[, ncol(res)] <- 3
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_4.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_1.RData")
tlist <- list ()
for( i in 1:length(res[[1]]$rmse) ){
toremove <-c( (1:length(res[[1]]$rmse))[-i], (1:length(res[[1]]$ARI))[-i]+ length(res[[1]]$rmse))
tt <- tres[,- toremove ]
tlist[[i]] <- cbind ( rep(colnames(tres)[i], nrow(tt)), tt  )
colnames(tlist[[i]])[c(1,2,3,4)] <- c("Method", "RMSE", "ARI", "noise_level")
}
df_simu <- do.call(rbind, tlist)
df_simu <- as.data.frame(df_simu)
df_simu$Method <- as.factor(df_simu$Method)
df_simu$RMSE <- as.numeric(df_simu$RMSE)
df_simu$ARI <- as.numeric(df_simu$ARI)
library(ggplot2)
P1 <- ggplot(df_simu[-which(df_simu$Method=="cEBMF0"),], aes(x=Method, y=RMSE, color=Method)) +
geom_boxplot()  +
#  scale_y_log10()+
facet_wrap(~noise_level ,scale="free",
labeller = as_labeller(function(x) paste("noise sd =", x)))+
theme_bw()+
theme(legend.position="none",
strip.background = element_rect(fill = "white"))+
xlab("")+
ggtitle("Tiled  bi-clustering model")+
scale_y_log10()
ggsave(P1, file="plot/tiling_simu.pdf",
width = 29.7,
height = 21,
units = "cm"
)
library(ggplot2)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_1.RData")
tres <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_2.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_3.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$ARI,res[[i]]$ noise_level ) ))
res[, ncol(res)] <- 3
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_4.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Package/comoR/sim/local_res/tiling_1.RData")
tlist <- list ()
for( i in 1:length(res[[1]]$rmse) ){
toremove <-c( (1:length(res[[1]]$rmse))[-i], (1:length(res[[1]]$ARI))[-i]+ length(res[[1]]$rmse))
tt <- tres[,- toremove ]
tlist[[i]] <- cbind ( rep(colnames(tres)[i], nrow(tt)), tt  )
colnames(tlist[[i]])[c(1,2,3,4)] <- c("Method", "RMSE", "ARI", "noise_level")
}
df_simu <- do.call(rbind, tlist)
df_simu <- as.data.frame(df_simu)
df_simu$Method <- as.factor(df_simu$Method)
df_simu$RMSE <- as.numeric(df_simu$RMSE)
df_simu$ARI <- as.numeric(df_simu$ARI)
library(ggplot2)
P1 <- ggplot(df_simu[-which(df_simu$Method=="cEBMF0"),], aes(x=Method, y=RMSE, color=Method)) +
geom_boxplot()  +
#  scale_y_log10()+
facet_wrap(~noise_level ,scale="free",
labeller = as_labeller(function(x) paste("noise sd =", x)))+
theme_bw()+
theme(legend.position="none",
strip.background = element_rect(fill = "white"))+
xlab("")+
ggtitle("Tiled  bi-clustering model")+
scale_y_log10()
ggsave(P1, file="plot/tiling_simu.pdf",
width = 29.7,
height = 21,
units = "cm"
)
P1
library(ggplot2)
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/tiling_1.RData")
tres <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/tiling_2.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/tiling_3.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse, res[[i]]$ARI,res[[i]]$ noise_level ) ))
res[, ncol(res)] <- 3
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/tiling_4.RData")
res  <- do.call( rbind, lapply ( 1:length(res) , function(i) c(res[[i]]$rmse,res[[i]]$ARI, res[[i]]$ noise_level ) ))
tres <- rbind(tres, res)
load("C:/Document/Serieux/Travail/Data_analysis_and_papers/cEBMF_experiment/sim/local_res/tiling_1.RData")
tlist <- list ()
for( i in 1:length(res[[1]]$rmse) ){
toremove <-c( (1:length(res[[1]]$rmse))[-i], (1:length(res[[1]]$ARI))[-i]+ length(res[[1]]$rmse))
tt <- tres[,- toremove ]
tlist[[i]] <- cbind ( rep(colnames(tres)[i], nrow(tt)), tt  )
colnames(tlist[[i]])[c(1,2,3,4)] <- c("Method", "RMSE", "ARI", "noise_level")
}
df_simu <- do.call(rbind, tlist)
df_simu <- as.data.frame(df_simu)
df_simu$Method <- as.factor(df_simu$Method)
df_simu$RMSE <- as.numeric(df_simu$RMSE)
library(ggplot2)
P1 <- ggplot(df_simu[-which(df_simu$Method=="cEBMF0"),], aes(x=Method, y=RMSE, color=Method)) +
geom_boxplot()  +
#  scale_y_log10()+
facet_wrap(~noise_level ,scale="free",
labeller = as_labeller(function(x) paste("noise sd =", x)))+
theme_bw()+
theme(legend.position="none",
strip.background = element_rect(fill = "white"))+
xlab("")+
ggtitle("Tiled  bi-clustering model")+
scale_y_log10()
P1
ggsave(P1, file="plot/tiling_simu.pdf",
width = 29.7,
height = 21,
units = "cm"
)
